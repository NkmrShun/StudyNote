# MYSQL #

## 什么是存储过程？有哪些优势 ##
存储过程的有点：
- 能够将代码封装起来
- 保存在数据库之中
- 让编程语言进行调用
- 存储过程是一个预编译的代码块，执行效率比较高
- 一个存储过程替代大量的T_SQL语句，可以降低网络通信量，提高通信效率
存储过程的缺点：
- 没个数据库的存储过程语法几乎都不一样，难以维护（不通用）
- 业务逻辑放在数据库上，难以迭代

## 数据库设计的三个范式是什么 ##
满足第三范式，那么就一定满足第二范式，满足第二范式就一定满足第一范式
- 第一范式：数据库表中的字段都是单一属性的，不可再分的。这个单一属性由基本类型构成，包括整形、实数、字符型、逻辑性、日期型等。**字段是最小的单元，不可再分**
	- 学生信息组成的学生信息表，由年龄、性别、学号等信息组成。这些字段不可再分，满足第一范式。学院字段可分为专业等信息，不满足第一范式。
- 第二范式：数据库表中不存在非关键字段对任一候选关键字段的部分函数依赖（部分函数依赖指的是存在组合关键字中的某些字段决定非关键字段的情况），也即所有非关键字段都完全依赖于任意一组候选关键字。**表中的字段必须完全依赖于全部主键而不是部分主键**
	- 其他字段组成的这行记录和主键表示的是同一个东西，而主键是唯一的，他们只要依赖于主键，也就成了唯一的。
	- 学号为1的同学，姓名为张三，年龄24岁。姓名和年龄都依赖于主键学号。
- 第三范式：在第二范式的基础上，数据表中如果不存在非关键字段对任一候选关键字段的传递函数依赖则符合第三范式。所谓的传递函数依赖，指的是如果存在“A>B>C”的决定关系，则C传递函数依赖于A。因此，满足第三范式的数据库表应该不存在如下依赖关系：关键字段>非关键字段x>非关键字段y。**非主键外的所有字段必须互不依赖**
	- 就是数据只在一个地方存储，不重复出现在多张表中，可以认为就是消除传递依赖
	- 比如，大学有很多系（数学系，金融系），这个数据组可能由系编号，系主任，系简介等字段组成。如果把这些字段放到学生信息表就会使非主键外的字段形成了依赖关系。这种情况应该建立系信息表，然后学生信息表添加系编号。

## 视图 ##
视图是一种基于数据表的虚表
- 视图是一种虚表
- 视图是建立在已有表的基础上，这些表成为基表
- 向视图提供数据内容的语句为SELECT语句，可以将视图理解为存储起来的SELECT语句
- 视图向用户提供基表数据的另一种表现形式
- 视图没有存储真正的数据，真正的数据还是存储在几层中
- 程序员虽然操作的是视图，但是最终视图还会转成操作基表
- 一个基表可以有0个或多个视图

需求需要什么样的数据，就提供什么样的数据。一方面能够让他们只关注自己的数据，另一方面也能保证数据表的一些保密数据不会泄露出去

## drop、delete、truncate有什么区别 ##
droptable
- 属于DDL
- 不可回滚
- 不可带where
- 表内容和结构删除
- 删除速度快

truncate table
- 属于DDL
- 不可回滚
- 不可带where
- 表内容删除
- 删除速度快

delete from
- 属于DML
- 可回滚
- 可带where
- 表结构无影响，根据where删除表内容
- 删除速度慢，需要逐行删除

**不需要一张表的时候，用drop**
**想删除部分表内容时，用delete，并且使用where语句**
**保留表而删除所有数据的时候用truncate**

## 超键、候选键、主键、外键分别是什么？ ##
- 超键：在关系中能唯一标识元组的属性集称为关系模式的超键。一个属性可以作为一个超键，多个属性组合一起也可以作为一个超键。超键包含候选键和主键。
- 候选键（候选码）：是最小超键，即没有亢余元素的超键。
- 主键（主码）：数据库表中对储存诗句对象予以唯一和完整标识的数据列或属性的组合。一个数据列只能有一个主键，且主键的取值不能缺失，即不能为空值（null）。
- 外键：在一个表中存在的另一个表的主键称此表的外键。

候选码与主码：
例子：邮寄地址（城市名，街道名，邮政编码，单位名，收件人）
- 它有两个候选键:{城市名，街道名} 和 {街道名，邮政编码}
- 如果我选取{城市名，街道名}作为唯一标识实体的属性，那么{城市名，街道名} 就是主码(主键)

## SQL约束 ##
- NOT NULL：用于空值字段的内容不能为空（null）
- UNIQUE：控制字段内容不能重复，一个表允许多个Unique约束
- PRIMARY KEY：用于空值内容不能重复，一个表只能存在一个
- FOREIGN KEY：用于预防破坏表之间的连接动作，也能防止非法数据插入外键列，因为它必须是它指向的那个表的值之一
- CHECK：控制字段的值得范围

## Mysql存储引擎 ##
Mysql的存储引擎又以下几种：
- InnoDB
- MRG_MYISAM
- MEMORY
- BALCKHOLE
- MyISAM
- CSV
- ARCHIVE
- PERFORMANCE_SCHEMA
- PEDERATED

常用的：
- InnoDB引擎：InnoDB提供了对数据库ACID事务的支持。并且还提供了行级锁和外键约束。它的设计目的就是处理大数据容量的数据库系统。
- MyIASM引擎：不提供事务支持，也不支持行级锁和外键
- MEMORY引擎：所有的数据都在内存里，数据的处理速度快，但是安全性不高。

同一个数据库也可以使用多种存储引擎的表。如果一个表修改要求比较高的事务处理，可以选择InnoDB。这个数据库中可以将查询要求比较高的表选择MyISAM存储。如果该数据库需要一个用于查询的临时表，可以选择MEMORY存储引擎。

## MyIASM和Innodb两种引擎所使用的索引的数据结构是什么？ ##
- MyIASM引擎，B+树的数据结构中存储的内容实际上是实际数据的地址值。也就是说它的索引和实际数据是分开的，只不过使用索引指向了实际数据。这种索引的模式被称为非聚集索引。
- Innodb引擎的索引的数据结构也是B+树，只不过数据结构中存储的都是实际的数据，这种索引有被称为聚集索引。

## varchar和char的区别 ##
Char是一种固定长度的类型，varchar是一种可变长度的类型

## MySQL中InnoDB引擎的行锁是通过加在什么上完成 ##

InnoDB是基于索引来完成行锁

例: select * from tab_with_index where id = 1 for update;

for update 可以根据条件来完成行锁锁定,并且 id 是有索引键的列,

如果 id 不是索引键那么InnoDB将完成表锁,,并发将无从谈起